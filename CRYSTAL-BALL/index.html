<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta content="width=device-width, initial-scale=1.0" name="viewport">
<title>ç”Ÿæ¶¯æ°´æ™¶çƒ</title>
<!-- google fonts -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans:ital,wght@0,100..900;1,100..900&family=Noto+Sans+TC:wght@100..900&display=swap" rel="stylesheet">
<script src="https://d3js.org/d3.v7.min.js"></script> 
<!--<script src="https://cdn.plot.ly/plotly-latest.min.js"></script>--> 
<script src="https://cdn.plot.ly/plotly-3.0.1.min.js" charset="utf-8"></script>
<style id="plotly.js-style-global"></style>
<!-- Icon Font Stylesheet -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css">
<!-- web Stylesheet -->
<link rel="stylesheet" href="css/crystal-ball.css">
</head>
<body>
<form name="form1" method="post" action="./3d2.aspx" id="form1">
  <div>
    <input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="/wEPDwULLTIwMTg0NTQzNjEPFgIeE1ZhbGlkYXRlUmVxdWVzdE1vZGUCAWRk41qxnYJmb+om/a/R1LKF/CC4Ep+tZlCmzeQy3qPINBk=">
  </div>
  <div>
    <input type="hidden" name="__VIEWSTATEGENERATOR" id="__VIEWSTATEGENERATOR" value="72DD9A14">
  </div>
  <div class="main"> 
    <!-- å·¦å´ï¼š3D åœ–è¡¨å€ -->
    <div id="plotArea" class="plot-area">
      <div id="myDiv" class="js-plotly-plot" style="width: 100%; height: 100%; position: relative;">
        <!--  demoåœ–ï¼Œè«‹åˆªæ‰ -->
			<img src="img/ball-bg.png"   alt=""  style="position: absolute; top:50%; left: 50%; transform: translate(-50%, -50%); z-index: 1; max-width: 100%; width: auto; max-height: 95%; height: auto;"/> 
			<img src="img/ball-demo.png" alt=""  style="position: absolute; top:50%; left: 50%; transform: translate(-50%, -50%); z-index: 2; max-width: 100%; width: auto; max-height: 95%; height: auto;"/>
	        <img src="img/ball-demo2.png" alt="" style="position: absolute; right: 5px; bottom: 10%;  width: 7%; max-width: 86px; min-width: 50px;"/>	    <!--  demoåœ–ï¼Œè«‹åˆªæ‰ --> 
      </div>
      <button type="button" id="toggleRotation" class="btn btn-rotation">æ—‹è½‰å±•ç¤º</button>
      <!--<button type="button" id="toggleRotation" class="btn-rotation rotating">æš«åœæ—‹è½‰</button>	-->
      <button id="highlightBtn" style="position: absolute; top: 50px; left: 10px; z-index: 10;display:none">é–ƒçˆå¿ƒç†å­¸é¡</button>
    </div>
    
    <!-- å³å´ï¼šå­¸é¡è³‡è¨Šé¡¯ç¤ºå€ -->
    <div id="infoPanel" class="info-panel">
      <div class="info-panel-section info-what">
        <h2 class="info-panel-title">ä»€éº¼æ˜¯ç”Ÿæ¶¯æ°´æ™¶çƒï¼Ÿ</h2>
        <div class="info-panel-card">
          <p>ç”Ÿæ¶¯æ°´æ™¶çƒæ˜¯ç”¨ä¸‰å€‹å‘åº¦é€²è¡Œå­¸é¡çš„åˆ†é¡ï¼šXè»¸æ˜¯ã€Œè‡ªç”±ã€å’Œã€Œè¦æº–ã€ï¼ŒYè»¸æ˜¯ã€Œäº‹ã€å’Œã€Œäººã€ï¼ŒZè»¸æ˜¯ã€Œæ€è€ƒã€å’Œã€Œå¯¦è¸ã€ã€‚</p>
          <p> å¦‚æœä½ å–œæ­¡è‡ªå·±æ±ºå®šã€å‰µæ„ç™¼æƒ³ã€å½ˆæ€§å¤§ï¼Œä»£è¡¨ä½ åå‘è‡ªç”±ï¼›å¦‚æœä½ å–œæ­¡æœ‰è¨ˆç•«ã€ç…§è¦å‰‡åšäº‹ï¼Œå‰‡åå‘è¦æº–ã€‚<br>
            åå¥½ã€Œäº‹ã€çš„äººå–œæ­¡æ“ä½œã€åˆ†æã€è™•ç†è³‡æ–™æˆ–è§£æ±ºå•é¡Œï¼›åå¥½ã€Œäººã€çš„äººå‰‡å–œæ­¡äº’å‹•ã€å¹«åŠ©åˆ¥äººæˆ–ä¸€èµ·åˆä½œã€‚<br>
            å‚¾å‘ã€Œæ€è€ƒã€çš„äººæ„›åˆ†æã€æ¨ç†èˆ‡ç†è§£èƒŒå¾ŒåŸç†ï¼›ã€Œå¯¦è¸ã€çš„äººå‰‡å–œæ­¡å‹•æ‰‹åšã€å¾å¯¦éš›ç¶“é©—ä¸­å­¸ç¿’ã€‚<br>
            äº†è§£è‡ªå·±åœ¨å“ªäº›å‘åº¦æ¯”è¼ƒæœ‰èˆˆè¶£ï¼Œæœ‰åŠ©æ–¼æ‰¾åˆ°é©åˆè‡ªå·±çš„å­¸ç¿’èˆ‡ç™¼å±•æ–¹å‘ã€‚ </p>
        </div>
      </div>
      <div class="info-panel-section info-interest">
        <h2 class="info-panel-title">ä½ çš„èˆˆè¶£å‚¾å‘ï¼š</h2>
        <div class="info-panel-card">
          <p>ä¾æ“šæ¸¬é©—çµæœï¼Œä½ çš„èˆˆè¶£ç‰¹è³ªå‚¾å‘<b class="text-secondary">é‡è¦–äººéš›äº’å‹•ã€éµå®ˆè¦çŸ©èˆ‡åˆ¶åº¦ã€‚</b></p>
        </div>
      </div>
      <div class="info-panel-section info-academic">
        <h2 class="info-panel-title">ä»¥ä¸‹æ˜¯èˆ‡ä½ ç‰¹è³ªå‚¾å‘è¼ƒç‚ºç›¸è¿‘çš„å‰10å€‹å­¸é¡ï¼š</h2>
        <div id="treeMenu" class="info-panel-card"> 
          <!--<div style="margin-bottom: 10px;">
            <div style="cursor: pointer; font-weight: bold; color: rgb(51, 102, 204); margin-bottom: 4px;">1. ä¸­åœ‹èªæ–‡å­¸é¡</div>
            <ul style="margin-left: 20px; display: none;">
              <li> ä¸­åœ‹èªæ–‡å­¸ç³»</li>
              <li> è¯èªæ–‡å­¸ç³»</li>
            </ul>
          </div>
          <div style="margin-bottom: 10px;">
            <div style="cursor: pointer; font-weight: bold; color: rgb(51, 102, 204); margin-bottom: 4px;">2. åœ‹éš›äº‹å‹™å­¸é¡</div>
            <ul style="margin-left: 20px; display: none;">
              <li> åœ‹éš›äº‹å‹™å­¸ç³»</li>
            </ul>
          </div>
          <div style="margin-bottom: 10px;">
            <div style="cursor: pointer; font-weight: bold; color: rgb(51, 102, 204); margin-bottom: 4px;">3. ä¸€èˆ¬å¤§çœ¾å‚³æ’­å­¸é¡</div>
            <ul style="margin-left: 20px; display: none;">
              <li> å¤§çœ¾å‚³æ’­å­¸ç³»</li>
              <li> å‚³æ’­ç®¡ç†å­¸ç³»</li>
              <li> é‹å‹•è³‡è¨Šå‚³æ’­å­¸ç³»</li>
            </ul>
          </div>
          <div style="margin-bottom: 10px;">
            <div style="cursor: pointer; font-weight: bold; color: rgb(51, 102, 204); margin-bottom: 4px;">4. åœ–æ›¸è³‡è¨Šæª”æ¡ˆå­¸é¡</div>
            <ul style="margin-left: 20px; display: none;">
              <li> åœ–æ›¸è³‡è¨Šå­¸ç³»</li>
            </ul>
          </div>
          <div style="margin-bottom: 10px;">
            <div style="cursor: pointer; font-weight: bold; color: rgb(51, 102, 204); margin-bottom: 4px;">5. ä¼æ¥­ç®¡ç†å­¸é¡</div>
            <ul style="margin-left: 20px; display: none;">
              <li> ä¼æ¥­ç®¡ç†å­¸ç³»</li>
              <li> åœ‹éš›ä¼æ¥­å­¸ç³»</li>
              <li> ç®¡ç†ç§‘å­¸å­¸ç³»</li>
              <li> ç§‘æŠ€ç®¡ç†å­¸ç³»</li>
            </ul>
          </div>
          <div style="margin-bottom: 10px;">
            <div style="cursor: pointer; font-weight: bold; color: rgb(51, 102, 204); margin-bottom: 4px;">6. è²¿æ˜“å­¸é¡</div>
            <ul style="margin-left: 20px; display: none;">
              <li> åœ‹éš›è²¿æ˜“å­¸ç³»</li>
            </ul>
          </div>
          <div style="margin-bottom: 10px;">
            <div style="cursor: pointer; font-weight: bold; color: rgb(51, 102, 204); margin-bottom: 4px;">7. éƒ½å·¿è¦åŠƒå­¸é¡</div>
            <ul style="margin-left: 20px; display: none;">
              <li> éƒ½å·¿è¦åŠƒå­¸ç³»</li>
            </ul>
          </div>
          <div style="margin-bottom: 10px;">
            <div style="cursor: pointer; font-weight: bold; color: rgb(51, 102, 204); margin-bottom: 4px;">8. è€å¹´æœå‹™å­¸é¡</div>
            <ul style="margin-left: 20px; display: none;">
              <li> é•·æœŸç…§è­·èˆ‡ç®¡ç†å­¸ç³»</li>
              <li> é«˜é½¡å¥åº·ç…§è­·å­¸ç³»</li>
              <li> è€äººæœå‹™äº‹æ¥­ç®¡ç†å­¸ç³»</li>
            </ul>
          </div>
          <div style="margin-bottom: 10px;">
            <div style="cursor: pointer; font-weight: bold; color: rgb(51, 102, 204); margin-bottom: 4px;">9. å…’ç«¥ä¿è‚²å­¸é¡</div>
            <ul style="margin-left: 20px; display: none;">
              <li> å…’ç«¥ä¿è‚²å­¸ç³»</li>
              <li> å®¶åº­èˆ‡å…’ç«¥ç™¼å±•å­¸ç³»</li>
            </ul>
          </div>
          <div style="margin-bottom: 10px;">
            <div style="cursor: pointer; font-weight: bold; color: rgb(51, 102, 204); margin-bottom: 4px;">10. è§€å…‰ä¼‘é–’å­¸é¡</div>
            <ul style="margin-left: 20px; display: none;">
              <li> è§€å…‰ä¼‘é–’å­¸ç³»</li>
              <li> è§€å…‰ä¼‘é–’ç®¡ç†å­¸ç³»</li>
              <li> ä¼‘é–’éŠæ†©å­¸ç³»</li>
            </ul>
          </div>--> 
        </div>
      </div>
      <div class="info-panel-section info-search">
        <h2 class="info-panel-title"> æœå°‹å­¸ç³»ï¼š
          <div class="input-group">
            <input type="text" class="form-control" list="Drop_dept" placeholder="è¼¸å…¥å­¸ç³»é—œéµå­—..." aria-label="è¼¸å…¥å­¸ç³»é—œéµå­—" aria-describedby="button-addon2" id="Searchdeptstr">
            <datalist id="Drop_dept">
              <option value="ç§‘å­¸æ•™è‚²å­¸ç³»"></option>
              <option value="æ•™è‚²å­¸ç³»"></option>
              <option value="æ•™è‚²è¡Œæ”¿å­¸ç³»"></option>
              <option value="å…¬æ°‘æ•™è‚²å­¸ç³»"></option>
              <option value="ç¤¾æœƒæ•™è‚²å­¸ç³»"></option>
              <option value="æˆäººåŠç¹¼çºŒæ•™è‚²å­¸ç³»"></option>
              <option value="æ•¸å­¸æ•™è‚²å­¸ç³»"></option>
              <option value="è‹±èªæ•™å­¸å­¸ç³»"></option>
              <option value="èªæ–‡æ•™è‚²å­¸ç³»"></option>
              <option value="å¹¼å…’æ•™è‚²å­¸ç³»"></option>
              <option value="å¹¼å…’èˆ‡å®¶åº­æ•™è‚²å­¸ç³»"></option>
              <option value="ç‰¹æ®Šæ•™è‚²å­¸ç³»"></option>
              <option value="é©æ‡‰é«”è‚²å­¸ç³»"></option>
              <option value="å­¸ç¿’ç§‘å­¸å­¸ç³»"></option>
              <option value="æ•™è‚²ç§‘æŠ€å­¸ç³»"></option>
              <option value="ç¾è¡“å­¸ç³»"></option>
              <option value="æ›¸ç•«è—è¡“å­¸ç³»"></option>
              <option value="é›•å¡‘å­¸ç³»"></option>
              <option value="è—è¡“èˆ‡è¨­è¨ˆå­¸ç³»"></option>
              <option value="å·¥è—è¨­è¨ˆå­¸ç³»"></option>
              <option value="ç¾è¡“å·¥è—å­¸ç³»"></option>
              <option value="è—è¡“è¡Œæ”¿å­¸ç³»"></option>
              <option value="éŸ³æ¨‚å­¸ç³»"></option>
              <option value="ä¸­åœ‹éŸ³æ¨‚å­¸ç³»"></option>
              <option value="æ‡‰ç”¨éŸ³æ¨‚å­¸ç³»"></option>
              <option value="æ°‘æ—éŸ³æ¨‚å­¸ç³»"></option>
              <option value="æˆ²æ›²éŸ³æ¨‚å­¸ç³»"></option>
              <option value="æˆ²åŠ‡å­¸ç³»"></option>
              <option value="è¡¨æ¼”è—è¡“å­¸ç³»"></option>
              <option value="åŠ‡å ´è—è¡“å­¸ç³»"></option>
              <option value="ä¸­åœ‹æˆ²åŠ‡å­¸ç³»"></option>
              <option value="æ°‘ä¿—æŠ€è—å­¸ç³»"></option>
              <option value="èˆè¹ˆå­¸ç³»"></option>
              <option value="æ¼”è—äº‹æ¥­ç®¡ç†å­¸ç³»"></option>
              <option value="è¦–è¦ºè—è¡“å­¸ç³»"></option>
              <option value="æ–°åª’é«”è—è¡“å­¸ç³»"></option>
              <option value="å¤šåª’é«”å‹•ç•«è—è¡“å­¸ç³»"></option>
              <option value="å½±è¦–å‰µä½œå­¸ç³»"></option>
              <option value="å½±è¦–è¨­è¨ˆå­¸ç³»"></option>
              <option value="è‡ºç£èªæ–‡å­¸ç³»"></option>
              <option value="ä¸­åœ‹èªæ–‡å­¸ç³»"></option>
              <option value="è¯èªæ–‡å­¸ç³»"></option>
              <option value="è‹±èªå­¸ç³»"></option>
              <option value="æ‡‰ç”¨è‹±èªå­¸ç³»"></option>
              <option value="æ—¥èªå­¸ç³»"></option>
              <option value="æ‡‰ç”¨æ—¥èªå­¸ç³»"></option>
              <option value="å¤–èªå­¸ç³»"></option>
              <option value="æ‡‰ç”¨å¤–èªå­¸ç³»"></option>
              <option value="æ­æ´²èªè¨€å­¸ç³»"></option>
              <option value="äºæ´²èªè¨€å­¸ç³»"></option>
              <option value="å®—æ•™å­¸ç³»"></option>
              <option value="ä½›æ•™å­¸ç³»"></option>
              <option value="å¤©ä¸»æ•™å­¸ç³»"></option>
              <option value="åŸºç£æ•™å­¸ç³»"></option>
              <option value="æ­·å²å­¸ç³»"></option>
              <option value="æ–‡åŒ–è³‡ç”¢èˆ‡ç™¼å±•å­¸ç³»"></option>
              <option value="äººé¡èˆ‡æ°‘æ—å­¸ç³»"></option>
              <option value="è—è¡“å²å­¸ç³»"></option>
              <option value="å“²å­¸å­¸ç³»"></option>
              <option value="è¨­è¨ˆå­¸ç³»"></option>
              <option value="æ™ºæ…§ç”Ÿæ´»è¨­è¨ˆå­¸ç³»"></option>
              <option value="è¦–è¦ºå‚³é”è¨­è¨ˆå­¸ç³»"></option>
              <option value="æ•¸ä½åª’é«”è¨­è¨ˆå­¸ç³»"></option>
              <option value="å¤šåª’é«”è¨­è¨ˆå­¸ç³»"></option>
              <option value="å‹•ç•«èˆ‡éŠæˆ²è¨­è¨ˆå­¸ç³»"></option>
              <option value="äº’å‹•è¨­è¨ˆå­¸ç³»"></option>
              <option value="å·¥æ¥­è¨­è¨ˆå­¸ç³»"></option>
              <option value="å•†æ¥­è¨­è¨ˆå­¸ç³»"></option>
              <option value="æ–‡åŒ–å‰µæ„èˆ‡è¨­è¨ˆå­¸ç³»"></option>
              <option value="ç©ºé–“è¨­è¨ˆå­¸ç³»"></option>
              <option value="å®¤å…§è¨­è¨ˆå­¸ç³»"></option>
              <option value="å…¨çƒç¶“æ¿Ÿå­¸ç³»"></option>
              <option value="åˆä½œç¶“æ¿Ÿå­¸ç³»"></option>
              <option value="ç¶“æ¿Ÿå­¸ç³»"></option>
              <option value="æ”¿æ²»å­¸ç³»"></option>
              <option value="ç¤¾æœƒå­¸ç³»"></option>
              <option value="çŠ¯ç½ªé˜²æ²»å­¸ç³»"></option>
              <option value="äººæ–‡ç¤¾æœƒå­¸ç³»"></option>
              <option value="æ•™è‚²å¿ƒç†å­¸ç³»"></option>
              <option value="å·¥å•†å¿ƒç†å­¸ç³»"></option>
              <option value="å¿ƒç†å­¸ç³»"></option>
              <option value="è¼”å°èˆ‡è«®å•†å¿ƒç†å­¸ç³»"></option>
              <option value="è‡¨åºŠå¿ƒç†å­¸ç³»"></option>
              <option value="åœ°ç†å­¸ç³»"></option>
              <option value="æ±äºå­¸ç³»"></option>
              <option value="æ±å—äºå­¸ç³»"></option>
              <option value="å€åŸŸç ”ç©¶å­¸ç³»"></option>
              <option value="å…¬å…±è¡Œæ”¿å­¸ç³»"></option>
              <option value="åœ°æ”¿å­¸ç³»"></option>
              <option value="å‹å‹•é—œä¿‚èˆ‡äººåŠ›è³‡æºå­¸ç³»"></option>
              <option value="åœ‹éš›äº‹å‹™å­¸ç³»"></option>
              <option value="å¤§çœ¾å‚³æ’­å­¸ç³»"></option>
              <option value="å‚³æ’­ç®¡ç†å­¸ç³»"></option>
              <option value="é‹å‹•è³‡è¨Šå‚³æ’­å­¸ç³»"></option>
              <option value="æ–°èå­¸ç³»"></option>
              <option value="å»£æ’­é›»è¦–å­¸ç³»"></option>
              <option value="å…¬å…±é—œä¿‚å­¸ç³»"></option>
              <option value="åœ–æ›¸è³‡è¨Šå­¸ç³»"></option>
              <option value="åœ–æ–‡å‚³æ’­å­¸ç³»"></option>
              <option value="å»£å‘Šå­¸ç³»"></option>
              <option value="è³‡è¨Šå‚³æ’­å­¸ç³»"></option>
              <option value="å•†æ¥­ç¶“ç‡Ÿå­¸ç³»"></option>
              <option value="å•†æ¥­æ•¸æ“šå­¸ç³»"></option>
              <option value="åœ‹éš›å•†å‹™å­¸ç³»"></option>
              <option value="æœƒè¨ˆå­¸ç³»"></option>
              <option value="æœƒè¨ˆè³‡è¨Šå­¸ç³»"></option>
              <option value="ä¼æ¥­ç®¡ç†å­¸ç³»"></option>
              <option value="åœ‹éš›ä¼æ¥­å­¸ç³»"></option>
              <option value="ç®¡ç†ç§‘å­¸å­¸ç³»"></option>
              <option value="ç§‘æŠ€ç®¡ç†å­¸ç³»"></option>
              <option value="åœ‹éš›è²¿æ˜“å­¸ç³»"></option>
              <option value="è²¡å‹™é‡‘èå­¸ç³»"></option>
              <option value="è²¡å‹™é‡‘èç®¡ç†å­¸ç³»"></option>
              <option value="è²¡å‹™å·¥ç¨‹å­¸ç³»"></option>
              <option value="é‡‘èç§‘æŠ€å­¸ç³»"></option>
              <option value="é¢¨éšªç®¡ç†èˆ‡ä¿éšªå­¸ç³»"></option>
              <option value="è²¡æ”¿å­¸ç³»"></option>
              <option value="ä¸å‹•ç”¢ç¶“ç‡Ÿå­¸ç³»"></option>
              <option value="è¡ŒéŠ·èˆ‡æµé€šå­¸ç³»"></option>
              <option value="æ•¸ä½è¡ŒéŠ·å­¸ç³»"></option>
              <option value="è¡ŒéŠ·ç®¡ç†å­¸ç³»"></option>
              <option value="é†«ç®¡å­¸ç³»"></option>
              <option value="å¥åº·ç”¢æ¥­ç®¡ç†å­¸ç³»"></option>
              <option value="æ³•å¾‹å­¸ç³»"></option>
              <option value="æµ·æ´‹æ³•å¾‹å­¸ç³»"></option>
              <option value="è²¡ç¶“æ³•å¾‹å­¸ç³»"></option>
              <option value="æ”¿æ²»æ³•å¾‹å­¸ç³»"></option>
              <option value="ç”Ÿå‘½ç§‘å­¸å­¸ç³»"></option>
              <option value="ç”Ÿç‰©å­¸ç³»"></option>
              <option value="æ˜†èŸ²å­¸ç³»"></option>
              <option value="å¾®ç”Ÿç‰©å­¸ç³»"></option>
              <option value="ç”Ÿç‰©ç§‘æŠ€å­¸ç³»"></option>
              <option value="ç”Ÿç‰©é†«å­¸å­¸ç³»"></option>
              <option value="æµ·æ´‹ç”Ÿç‰©ç§‘æŠ€å­¸ç³»"></option>
              <option value="ç”Ÿç‰©åŒ–å­¸å­¸ç³»"></option>
              <option value="ç”ŸåŒ–ç§‘æŠ€å­¸ç³»"></option>
              <option value="åŒ–å­¸å­¸ç³»"></option>
              <option value="åœ°çƒç§‘å­¸å­¸ç³»"></option>
              <option value="æµ·æ´‹ç§‘å­¸å­¸ç³»"></option>
              <option value="ç‰©ç†å­¸ç³»"></option>
              <option value="å¤§æ°£ç§‘å­¸å­¸ç³»"></option>
              <option value="å¤ªç©ºç§‘å­¸å­¸ç³»"></option>
              <option value="æ•¸å­¸å­¸ç³»"></option>
              <option value="çµ±è¨ˆå­¸ç³»"></option>
              <option value="çµ±è¨ˆè³‡è¨Šå­¸ç³»"></option>
              <option value="è³‡æ–™ç§‘å­¸å­¸ç³»"></option>
              <option value="è³‡è¨Šå·¥ç¨‹å­¸ç³»"></option>
              <option value="è³‡è¨Šç§‘å­¸å­¸ç³»"></option>
              <option value="è³‡è¨Šç¶²è·¯å­¸ç³»"></option>
              <option value="è»Ÿé«”å·¥ç¨‹å­¸ç³»"></option>
              <option value="è³‡è¨Šç®¡ç†å­¸ç³»"></option>
              <option value="é†«å­¸è³‡è¨Šå­¸ç³»"></option>
              <option value="æ™ºæ…§å·¥ç¨‹å­¸ç³»"></option>
              <option value="é›»æ©Ÿå·¥ç¨‹å­¸ç³»"></option>
              <option value="å…‰é›»å·¥ç¨‹å­¸ç³»"></option>
              <option value="åŠå°é«”å·¥ç¨‹å­¸ç³»"></option>
              <option value="é€šè¨Šå·¥ç¨‹å­¸ç³»"></option>
              <option value="é›»å­å·¥ç¨‹å­¸ç³»"></option>
              <option value="é€ èˆ¹å·¥ç¨‹å­¸ç³»"></option>
              <option value="èƒ½æºå·¥ç¨‹å­¸ç³»"></option>
              <option value="å†·å‡ç©ºèª¿èˆ‡èƒ½æºå­¸ç³»"></option>
              <option value="è¼ªæ©Ÿå·¥ç¨‹å­¸ç³»"></option>
              <option value="ç”Ÿç‰©æ©Ÿé›»å·¥ç¨‹å­¸ç³»"></option>
              <option value="æ©Ÿæ¢°å·¥ç¨‹å­¸ç³»"></option>
              <option value="è»Šè¼›å·¥ç¨‹å­¸ç³»"></option>
              <option value="èˆªç©ºå·¥ç¨‹å­¸ç³»"></option>
              <option value="æ©Ÿé›»å·¥ç¨‹å­¸ç³»"></option>
              <option value="åœŸæœ¨å·¥ç¨‹å­¸ç³»"></option>
              <option value="ç‡Ÿå»ºå·¥ç¨‹å­¸ç³»"></option>
              <option value="å…¬å…±å®‰å…¨èˆ‡æ¶ˆé˜²å­¸ç³»"></option>
              <option value="ç©ºé–“è³‡è¨Šå­¸ç³»"></option>
              <option value="åŒ–å­¸å·¥ç¨‹å­¸ç³»"></option>
              <option value="ææ–™ç§‘å­¸èˆ‡å·¥ç¨‹å­¸ç³»"></option>
              <option value="ææ–™ç§‘å­¸å­¸ç³»"></option>
              <option value="å·¥æ¥­å·¥ç¨‹èˆ‡ç®¡ç†å­¸ç³»"></option>
              <option value="æ™ºæ…§è£½é€ å·¥ç¨‹å­¸ç³»"></option>
              <option value="å·¥æ¥­æ•™è‚²å­¸ç³»"></option>
              <option value="å·¥æ¥­ç®¡ç†å­¸ç³»"></option>
              <option value="ç´¡ç¹”å·¥ç¨‹å­¸ç³»"></option>
              <option value="ç’°å¢ƒå·¥ç¨‹å­¸ç³»"></option>
              <option value="ç’°å¢ƒèˆ‡å®‰å…¨è¡›ç”Ÿå·¥ç¨‹å­¸ç³»"></option>
              <option value="æ²³æµ·å·¥ç¨‹å­¸ç³»"></option>
              <option value="ç”Ÿé†«å·¥ç¨‹å­¸ç³»"></option>
              <option value="é†«ç™‚å™¨æç§‘æŠ€å­¸ç³»"></option>
              <option value="å»ºç¯‰å­¸ç³»"></option>
              <option value="æ™¯è§€è¨­è¨ˆå­¸ç³»"></option>
              <option value="éƒ½å·¿è¦åŠƒå­¸ç³»"></option>
              <option value="è¾²è—å­¸ç³»"></option>
              <option value="è¾²å ´ç®¡ç†å­¸ç³»"></option>
              <option value="æ¤ç‰©é†«å­¸å­¸ç³»"></option>
              <option value="è¾²æ¥­ç§‘æŠ€å­¸ç³»"></option>
              <option value="åœŸå£¤ç’°å¢ƒç§‘å­¸å­¸ç³»"></option>
              <option value="è¾²æ¥­åŒ–å­¸å­¸ç³»"></option>
              <option value="å‹•ç‰©ç§‘å­¸å­¸ç³»"></option>
              <option value="å¯µç‰©ç¾å®¹èˆ‡ç…§è­·å­¸ç³»"></option>
              <option value="åœ’è—å­¸ç³»"></option>
              <option value="è¾²æ¥­ç¶“æ¿Ÿå­¸ç³»"></option>
              <option value="è¾²ä¼æ¥­ç®¡ç†å­¸ç³»"></option>
              <option value="ç”Ÿç‰©ç”¢æ¥­ç®¡ç†å­¸ç³»"></option>
              <option value="é£Ÿå“ç§‘å­¸å­¸ç³»"></option>
              <option value="é£Ÿå“å®‰å…¨èˆ‡æª¢é©—å­¸ç³»"></option>
              <option value="æ°´ç”¢é£Ÿå“ç§‘å­¸å­¸ç³»"></option>
              <option value="æ£®æ—å­¸ç³»"></option>
              <option value="æœ¨æç§‘å­¸å­¸ç³»"></option>
              <option value="æ°´ç”¢é¤Šæ®–å­¸ç³»"></option>
              <option value="æ¼æ¥­ç§‘å­¸å­¸ç³»"></option>
              <option value="ç¸é†«å­¸ç³»"></option>
              <option value="å‘¼å¸æ²»ç™‚å­¸ç³»"></option>
              <option value="é†«å­¸å­¸ç³»"></option>
              <option value="ä¸­é†«å­¸ç³»"></option>
              <option value="å…¬å…±è¡›ç”Ÿå­¸ç³»"></option>
              <option value="è·æ¥­å®‰å…¨è¡›ç”Ÿå­¸ç³»"></option>
              <option value="å¥åº·èˆ‡è¡›ç”Ÿæ•™è‚²å­¸ç³»"></option>
              <option value="è—¥å­¸å­¸ç³»"></option>
              <option value="è—¥ç”¨æ¤ç‰©å­¸ç³»"></option>
              <option value="ä¸­åœ‹è—¥å­¸å­¸ç³»"></option>
              <option value="åŒ–å¦å“ç§‘å­¸å­¸ç³»"></option>
              <option value="ç”ŸæŠ€è£½è—¥å­¸ç³»"></option>
              <option value="ç‰©ç†æ²»ç™‚å­¸ç³»"></option>
              <option value="è·èƒ½æ²»ç™‚å­¸ç³»"></option>
              <option value="èªè¨€èˆ‡è½åŠ›æ²»ç™‚å­¸ç³»"></option>
              <option value="é‹å‹•é†«å­¸å­¸ç³»"></option>
              <option value="ç‡Ÿé¤Šå­¸ç³»"></option>
              <option value="è­·ç†å­¸ç³»"></option>
              <option value="é†«å­¸æŠ€è¡“åŠæª¢é©—å­¸ç³»"></option>
              <option value="é†«å­¸å½±åƒæš¨æ”¾å°„ç§‘å­¸å­¸ç³»"></option>
              <option value="è¦–å…‰å­¸ç³»"></option>
              <option value="ç‰™é†«å­¸ç³»"></option>
              <option value="ç‰™é«”æŠ€è¡“å­¸ç³»"></option>
              <option value="å£è…”è¡›ç”Ÿå­¸ç³»"></option>
              <option value="é•·æœŸç…§è­·èˆ‡ç®¡ç†å­¸ç³»"></option>
              <option value="é«˜é½¡å¥åº·ç…§è­·å­¸ç³»"></option>
              <option value="è€äººæœå‹™äº‹æ¥­ç®¡ç†å­¸ç³»"></option>
              <option value="ç¤¾æœƒå·¥ä½œå­¸ç³»"></option>
              <option value="é†«å­¸ç¤¾æœƒå·¥ä½œå­¸ç³»"></option>
              <option value="ç”Ÿå‘½ç¦®å„€å­¸ç³»"></option>
              <option value="å…’ç«¥ä¿è‚²å­¸ç³»"></option>
              <option value="å®¶åº­èˆ‡å…’ç«¥ç™¼å±•å­¸ç³»"></option>
              <option value="é¤æ—…ç®¡ç†å­¸ç³»"></option>
              <option value="é¤é£²ç®¡ç†å­¸ç³»"></option>
              <option value="æ—…é¤¨ç®¡ç†å­¸ç³»"></option>
              <option value="é¤é£²å»šè—å­¸ç³»"></option>
              <option value="è§€å…‰ä¼‘é–’å­¸ç³»"></option>
              <option value="è§€å…‰ä¼‘é–’ç®¡ç†å­¸ç³»"></option>
              <option value="ä¼‘é–’éŠæ†©å­¸ç³»"></option>
              <option value="é«”è‚²å­¸ç³»"></option>
              <option value="é‹å‹•ç§‘å­¸å­¸ç³»"></option>
              <option value="é‹å‹•ç”¢æ¥­èˆ‡ç®¡ç†å­¸ç³»"></option>
              <option value="é‹å‹•èˆ‡ä¼‘é–’ç®¡ç†å­¸ç³»"></option>
              <option value="é‹å‹•èˆ‡å¥åº·ç®¡ç†å­¸ç³»"></option>
              <option value="ç”Ÿæ´»æ‡‰ç”¨ç§‘å­¸å­¸ç³»"></option>
              <option value="æœé£¾è¨­è¨ˆå­¸ç³»"></option>
              <option value="æœé£¾ç¶“ç‡ŸåŠç®¡ç†å­¸ç³»"></option>
              <option value="æ™‚å°šç”¢æ¥­ç¶“ç‡Ÿå­¸ç³»"></option>
              <option value="ç¾å®¹èˆ‡é€ å‹è¨­è¨ˆå­¸ç³»"></option>
              <option value="åŒ–å¦å“æ‡‰ç”¨èˆ‡ç®¡ç†å­¸ç³»"></option>
              <option value="ç¾é«®å­¸ç³»"></option>
              <option value="é‹è¼¸ç®¡ç†å­¸ç³»"></option>
              <option value="èˆªç©ºæœå‹™èˆ‡ç®¡ç†å­¸ç³»"></option>
              <option value="é£›è¡Œèˆ‡èˆªç©ºä½œæ¥­å­¸ç³»"></option>
              <option value="ç©ºé‹ç®¡ç†å­¸ç³»"></option>
              <option value="èˆªæµ·å­¸ç³»"></option>
              <option value="èˆªé‹ç®¡ç†å­¸ç³»"></option>
              <option value="ç’°å¢ƒè³‡æºå­¸ç³»"></option>
              <option value="æ°´åœŸä¿æŒå­¸ç³»"></option>
              <option value="ç”Ÿæ…‹äººæ–‡å­¸ç³»"></option>
            </datalist>
            <button class="btn btn-light" type="button" id="button-addon2"><i class="fa-solid fa-magnifying-glass"></i></button>
          </div>
        </h2>
        <div id="resultdiv"> </div>
        <div class="info-panel-btn">
          <button class="btn btn-light" type="button" id="btnClearSearch">æ¸…é™¤</button>
        </div>
      </div>
    </div>
  </div>
  <div id="loadingMessage" class="loading-msg" style="display: block;"><i class="fa-solid fa-paintbrush fa-spin"></i><span>åœ–å½¢ç¹ªè£½ä¸­ï¼Œè«‹ç¨å€™â€¦</span></div>
</form>
<script src="http://140.122.118.47/careerinfo/itemCs_full.js"></script> 
<script>
        console.log("é–‹å§‹è®€å–");
        const rawData = [
            { cat: 'ä¸­åœ‹èªæ–‡å­¸é¡', dept: 'ä¸­åœ‹èªæ–‡å­¸ç³»', catintro:'ä¸­åœ‹èªæ–‡å­¸é¡ä¸»è¦ç ”ç©¶ä¸­åœ‹èªè¨€å’Œæ–‡å­¸ï¼ŒåŒ…æ‹¬å¤ä»£å’Œç¾ä»£çš„èªè¨€çµæ§‹ã€æ–‡å­¸ä½œå“ã€æ–‡åŒ–èƒŒæ™¯åŠå…¶æ¼”è®Šã€‚å­¸ç”Ÿå°‡å­¸ç¿’å¦‚ä½•åˆ†æå’Œç†è§£ä¸­åœ‹æ–‡å­¸ä½œå“ï¼Œä¸¦æ¢è¨å…¶åœ¨ä¸åŒæ­·å²æ™‚æœŸçš„ç¤¾æœƒå’Œæ–‡åŒ–æ„ç¾©ã€‚' },
            { cat: 'ä¸­åœ‹èªæ–‡å­¸é¡', dept: 'è¯èªæ–‡å­¸ç³»', catintro: 'ä¸­åœ‹èªæ–‡å­¸é¡ä¸»è¦ç ”ç©¶ä¸­åœ‹èªè¨€å’Œæ–‡å­¸ï¼ŒåŒ…æ‹¬å¤ä»£å’Œç¾ä»£çš„èªè¨€çµæ§‹ã€æ–‡å­¸ä½œå“ã€æ–‡åŒ–èƒŒæ™¯åŠå…¶æ¼”è®Šã€‚å­¸ç”Ÿå°‡å­¸ç¿’å¦‚ä½•åˆ†æå’Œç†è§£ä¸­åœ‹æ–‡å­¸ä½œå“ï¼Œä¸¦æ¢è¨å…¶åœ¨ä¸åŒæ­·å²æ™‚æœŸçš„ç¤¾æœƒå’Œæ–‡åŒ–æ„ç¾©ã€‚' },
            { cat: 'åœ‹éš›äº‹å‹™å­¸é¡', dept: 'åœ‹éš›äº‹å‹™å­¸ç³»', catintro: 'åœ‹éš›äº‹å‹™å­¸é¡ä¸»è¦ç ”ç©¶åœ‹éš›é—œä¿‚ã€å…¨çƒæ”¿æ²»ç¶“æ¿Ÿã€å¤–äº¤æ”¿ç­–åŠåœ‹éš›çµ„ç¹”ç­‰è­°é¡Œã€‚å­¸ç”Ÿå°‡å­¸ç¿’å¦‚ä½•åˆ†æå’Œè§£æ±ºè·¨åœ‹ç•Œçš„å•é¡Œï¼Œä¸¦ç†è§£ä¸åŒåœ‹å®¶ä¹‹é–“çš„äº’å‹•å’Œå½±éŸ¿ã€‚' },
            { cat: 'ä¸€èˆ¬å¤§çœ¾å‚³æ’­å­¸é¡', dept: 'å¤§çœ¾å‚³æ’­å­¸ç³»', catintro: 'å¤§çœ¾å‚³æ’­å­¸é¡ä¸»è¦ç ”ç©¶å¦‚ä½•é€éå„ç¨®åª’é«”ï¼ˆä¾‹å¦‚ï¼šé›»è¦–ã€å»£æ’­ã€å ±ç´™ã€ç¶²è·¯ç­‰ï¼‰é€²è¡Œè¨Šæ¯å‚³éå’Œäº¤æµã€‚é€™å€‹å­¸é¡æ¶µè“‹äº†æ–°èå­¸ã€å»£å‘Šå­¸ã€å…¬å…±é—œä¿‚ã€æ•¸ä½åª’é«”ç­‰å¤šå€‹é ˜åŸŸï¼Œæ—¨åœ¨åŸ¹é¤Šå­¸ç”Ÿå…·å‚™åª’é«”è£½ä½œã€å…§å®¹å‰µä½œã€å»£å‘Šç‡ŸéŠ·åŠç­–ç•¥æºé€šç­‰èƒ½åŠ›ã€‚' },
            { cat: 'ä¸€èˆ¬å¤§çœ¾å‚³æ’­å­¸é¡', dept: 'å‚³æ’­ç®¡ç†å­¸ç³»', catintro: 'å¤§çœ¾å‚³æ’­å­¸é¡ä¸»è¦ç ”ç©¶å¦‚ä½•é€éå„ç¨®åª’é«”ï¼ˆä¾‹å¦‚ï¼šé›»è¦–ã€å»£æ’­ã€å ±ç´™ã€ç¶²è·¯ç­‰ï¼‰é€²è¡Œè¨Šæ¯å‚³éå’Œäº¤æµã€‚é€™å€‹å­¸é¡æ¶µè“‹äº†æ–°èå­¸ã€å»£å‘Šå­¸ã€å…¬å…±é—œä¿‚ã€æ•¸ä½åª’é«”ç­‰å¤šå€‹é ˜åŸŸï¼Œæ—¨åœ¨åŸ¹é¤Šå­¸ç”Ÿå…·å‚™åª’é«”è£½ä½œã€å…§å®¹å‰µä½œã€å»£å‘Šç‡ŸéŠ·åŠç­–ç•¥æºé€šç­‰èƒ½åŠ›ã€‚' },
            { cat: 'ä¸€èˆ¬å¤§çœ¾å‚³æ’­å­¸é¡', dept: 'é‹å‹•è³‡è¨Šå‚³æ’­å­¸ç³»', catintro: 'å¤§çœ¾å‚³æ’­å­¸é¡ä¸»è¦ç ”ç©¶å¦‚ä½•é€éå„ç¨®åª’é«”ï¼ˆä¾‹å¦‚ï¼šé›»è¦–ã€å»£æ’­ã€å ±ç´™ã€ç¶²è·¯ç­‰ï¼‰é€²è¡Œè¨Šæ¯å‚³éå’Œäº¤æµã€‚é€™å€‹å­¸é¡æ¶µè“‹äº†æ–°èå­¸ã€å»£å‘Šå­¸ã€å…¬å…±é—œä¿‚ã€æ•¸ä½åª’é«”ç­‰å¤šå€‹é ˜åŸŸï¼Œæ—¨åœ¨åŸ¹é¤Šå­¸ç”Ÿå…·å‚™åª’é«”è£½ä½œã€å…§å®¹å‰µä½œã€å»£å‘Šç‡ŸéŠ·åŠç­–ç•¥æºé€šç­‰èƒ½åŠ›ã€‚' },
            { cat: 'åœ–æ›¸è³‡è¨Šæª”æ¡ˆå­¸é¡', dept: 'åœ–æ›¸è³‡è¨Šå­¸ç³»', catintro: 'åœ–æ›¸è³‡è¨Šæª”æ¡ˆå­¸é¡ä¸»è¦ç ”ç©¶å¦‚ä½•æœ‰æ•ˆåœ°ç®¡ç†ã€çµ„ç¹”å’Œæª¢ç´¢å„ç¨®å½¢å¼çš„è³‡è¨Šï¼ŒåŒ…æ‹¬æ›¸ç±ã€æœŸåˆŠã€é›»å­è³‡æºå’Œæª”æ¡ˆã€‚é€™å€‹å­¸é¡æ¶µè“‹äº†åœ–æ›¸é¤¨å­¸ã€è³‡è¨Šç§‘å­¸å’Œæª”æ¡ˆç®¡ç†ç­‰é ˜åŸŸï¼Œæ—¨åœ¨åŸ¹é¤Šå­¸ç”Ÿå…·å‚™è³‡è¨Šçµ„ç¹”ã€ç®¡ç†å’Œæœå‹™çš„å°ˆæ¥­èƒ½åŠ›ã€‚' },
            { cat: 'ä¼æ¥­ç®¡ç†å­¸é¡', dept: 'ä¼æ¥­ç®¡ç†å­¸ç³»', catintro: 'ä¼æ¥­ç®¡ç†å­¸é¡ä¸»è¦ç ”ç©¶å¦‚ä½•æœ‰æ•ˆåœ°ç¶“ç‡Ÿå’Œç®¡ç†ä¸€å€‹çµ„ç¹”æˆ–ä¼æ¥­ã€‚é€™å€‹å­¸é¡æ¶µè“‹äº†å¤šç¨®ç®¡ç†é ˜åŸŸï¼ŒåŒ…æ‹¬äººåŠ›è³‡æºç®¡ç†ã€è²¡å‹™ç®¡ç†ã€è¡ŒéŠ·ç®¡ç†ã€ç­–ç•¥ç®¡ç†ç­‰ã€‚å­¸ç”Ÿå°‡å­¸ç¿’å¦‚ä½•åˆ¶å®šè¨ˆåŠƒã€çµ„ç¹”è³‡æºã€é ˜å°åœ˜éšŠä»¥åŠæ§åˆ¶å’Œè©•ä¼°ä¼æ¥­é‹ä½œã€‚' },
            { cat: 'ä¼æ¥­ç®¡ç†å­¸é¡', dept: 'åœ‹éš›ä¼æ¥­å­¸ç³»', catintro: 'ä¼æ¥­ç®¡ç†å­¸é¡ä¸»è¦ç ”ç©¶å¦‚ä½•æœ‰æ•ˆåœ°ç¶“ç‡Ÿå’Œç®¡ç†ä¸€å€‹çµ„ç¹”æˆ–ä¼æ¥­ã€‚é€™å€‹å­¸é¡æ¶µè“‹äº†å¤šç¨®ç®¡ç†é ˜åŸŸï¼ŒåŒ…æ‹¬äººåŠ›è³‡æºç®¡ç†ã€è²¡å‹™ç®¡ç†ã€è¡ŒéŠ·ç®¡ç†ã€ç­–ç•¥ç®¡ç†ç­‰ã€‚å­¸ç”Ÿå°‡å­¸ç¿’å¦‚ä½•åˆ¶å®šè¨ˆåŠƒã€çµ„ç¹”è³‡æºã€é ˜å°åœ˜éšŠä»¥åŠæ§åˆ¶å’Œè©•ä¼°ä¼æ¥­é‹ä½œã€‚' },
            { cat: 'ä¼æ¥­ç®¡ç†å­¸é¡', dept: 'ç®¡ç†ç§‘å­¸å­¸ç³»', catintro: 'ä¼æ¥­ç®¡ç†å­¸é¡ä¸»è¦ç ”ç©¶å¦‚ä½•æœ‰æ•ˆåœ°ç¶“ç‡Ÿå’Œç®¡ç†ä¸€å€‹çµ„ç¹”æˆ–ä¼æ¥­ã€‚é€™å€‹å­¸é¡æ¶µè“‹äº†å¤šç¨®ç®¡ç†é ˜åŸŸï¼ŒåŒ…æ‹¬äººåŠ›è³‡æºç®¡ç†ã€è²¡å‹™ç®¡ç†ã€è¡ŒéŠ·ç®¡ç†ã€ç­–ç•¥ç®¡ç†ç­‰ã€‚å­¸ç”Ÿå°‡å­¸ç¿’å¦‚ä½•åˆ¶å®šè¨ˆåŠƒã€çµ„ç¹”è³‡æºã€é ˜å°åœ˜éšŠä»¥åŠæ§åˆ¶å’Œè©•ä¼°ä¼æ¥­é‹ä½œã€‚' },
            { cat: 'ä¼æ¥­ç®¡ç†å­¸é¡', dept: 'ç§‘æŠ€ç®¡ç†å­¸ç³»', catintro: 'ä¼æ¥­ç®¡ç†å­¸é¡ä¸»è¦ç ”ç©¶å¦‚ä½•æœ‰æ•ˆåœ°ç¶“ç‡Ÿå’Œç®¡ç†ä¸€å€‹çµ„ç¹”æˆ–ä¼æ¥­ã€‚é€™å€‹å­¸é¡æ¶µè“‹äº†å¤šç¨®ç®¡ç†é ˜åŸŸï¼ŒåŒ…æ‹¬äººåŠ›è³‡æºç®¡ç†ã€è²¡å‹™ç®¡ç†ã€è¡ŒéŠ·ç®¡ç†ã€ç­–ç•¥ç®¡ç†ç­‰ã€‚å­¸ç”Ÿå°‡å­¸ç¿’å¦‚ä½•åˆ¶å®šè¨ˆåŠƒã€çµ„ç¹”è³‡æºã€é ˜å°åœ˜éšŠä»¥åŠæ§åˆ¶å’Œè©•ä¼°ä¼æ¥­é‹ä½œã€‚' },
            { cat: 'è²¿æ˜“å­¸é¡', dept: 'åœ‹éš›è²¿æ˜“å­¸ç³»', catintro: 'è²¿æ˜“å­¸é¡ä¸»è¦ç ”ç©¶åœ‹éš›è²¿æ˜“ç†è«–èˆ‡å¯¦å‹™ï¼Œæ¶µè“‹é€²å‡ºå£æ¥­å‹™ã€åœ‹éš›å¸‚å ´åˆ†æã€è²¿æ˜“æ³•è¦ã€ç‰©æµç®¡ç†ç­‰é ˜åŸŸã€‚å­¸ç”Ÿå°‡å­¸ç¿’å¦‚ä½•åœ¨å…¨çƒå¸‚å ´ä¸­é€²è¡Œè²¿æ˜“æ´»å‹•ï¼Œä¸¦äº†è§£ä¸åŒåœ‹å®¶çš„è²¿æ˜“æ”¿ç­–å’Œæ–‡åŒ–å·®ç•°ï¼Œä»¥ä¾¿æœ‰æ•ˆåœ°é€²è¡Œè·¨åœ‹äº¤æ˜“ã€‚' },
            { cat: 'éƒ½å·¿è¦åŠƒå­¸é¡', dept: 'éƒ½å·¿è¦åŠƒå­¸ç³»', catintro: 'éƒ½å¸‚è¦åŠƒå­¸é¡ä¸»è¦ç ”ç©¶å¦‚ä½•æœ‰æ•ˆåœ°åˆ©ç”¨åœŸåœ°è³‡æºï¼Œè¨­è¨ˆå’Œç®¡ç†åŸå¸‚ç©ºé–“ï¼Œä»¥æ»¿è¶³å±…æ°‘çš„ç”Ÿæ´»éœ€æ±‚ã€‚é€™å€‹å­¸é¡æ¶µè“‹äº†å¾åŸå¸‚è¨­è¨ˆã€äº¤é€šè¦åŠƒåˆ°ç’°å¢ƒä¿è­·ç­‰å¤šæ–¹é¢çš„å…§å®¹ï¼Œç›®çš„æ˜¯å‰µé€ ä¸€å€‹åŠŸèƒ½å®Œå–„ã€ç’°å¢ƒå‹å¥½ä¸”æ°¸çºŒç™¼å±•çš„åŸå¸‚ã€‚' },
            { cat: 'è€å¹´æœå‹™å­¸é¡', dept: 'é•·æœŸç…§è­·èˆ‡ç®¡ç†å­¸ç³»', catintro: 'è€å¹´æœå‹™å­¸é¡ä¸»è¦ç ”ç©¶å¦‚ä½•æä¾›é«˜å“è³ªçš„æœå‹™èˆ‡æ”¯æŒçµ¦è€å¹´äººï¼Œæ¶µè“‹å¥åº·ç…§è­·ã€å¿ƒç†æ”¯æŒã€ç¤¾æœƒåƒèˆ‡ç­‰å¤šæ–¹é¢ã€‚é€™å€‹å­¸é¡æ—¨åœ¨åŸ¹é¤Šå­¸ç”Ÿå…·å‚™å°ˆæ¥­çŸ¥è­˜å’ŒæŠ€èƒ½ï¼Œä»¥æ‡‰å°è€å¹´äººå£æ—¥ç›Šå¢é•·æ‰€å¸¶ä¾†çš„æŒ‘æˆ°ã€‚' },
            { cat: 'è€å¹´æœå‹™å­¸é¡', dept: 'é«˜é½¡å¥åº·ç…§è­·å­¸ç³»', catintro: 'è€å¹´æœå‹™å­¸é¡ä¸»è¦ç ”ç©¶å¦‚ä½•æä¾›é«˜å“è³ªçš„æœå‹™èˆ‡æ”¯æŒçµ¦è€å¹´äººï¼Œæ¶µè“‹å¥åº·ç…§è­·ã€å¿ƒç†æ”¯æŒã€ç¤¾æœƒåƒèˆ‡ç­‰å¤šæ–¹é¢ã€‚é€™å€‹å­¸é¡æ—¨åœ¨åŸ¹é¤Šå­¸ç”Ÿå…·å‚™å°ˆæ¥­çŸ¥è­˜å’ŒæŠ€èƒ½ï¼Œä»¥æ‡‰å°è€å¹´äººå£æ—¥ç›Šå¢é•·æ‰€å¸¶ä¾†çš„æŒ‘æˆ°ã€‚' },
            { cat: 'è€å¹´æœå‹™å­¸é¡', dept: 'è€äººæœå‹™äº‹æ¥­ç®¡ç†å­¸ç³»', catintro: 'è€å¹´æœå‹™å­¸é¡ä¸»è¦ç ”ç©¶å¦‚ä½•æä¾›é«˜å“è³ªçš„æœå‹™èˆ‡æ”¯æŒçµ¦è€å¹´äººï¼Œæ¶µè“‹å¥åº·ç…§è­·ã€å¿ƒç†æ”¯æŒã€ç¤¾æœƒåƒèˆ‡ç­‰å¤šæ–¹é¢ã€‚é€™å€‹å­¸é¡æ—¨åœ¨åŸ¹é¤Šå­¸ç”Ÿå…·å‚™å°ˆæ¥­çŸ¥è­˜å’ŒæŠ€èƒ½ï¼Œä»¥æ‡‰å°è€å¹´äººå£æ—¥ç›Šå¢é•·æ‰€å¸¶ä¾†çš„æŒ‘æˆ°ã€‚' },
            { cat: 'å…’ç«¥ä¿è‚²å­¸é¡', dept: 'å…’ç«¥ä¿è‚²å­¸ç³»', catintro: 'å…’ç«¥ä¿è‚²å­¸é¡ä¸»è¦ç ”ç©¶å’Œå¯¦è¸å¦‚ä½•ç…§é¡§ã€æ•™è‚²å’Œæ”¯æŒå…’ç«¥çš„å…¨é¢ç™¼å±•ã€‚é€™å€‹å­¸é¡æ¶µè“‹äº†å¾å¬°å¹¼å…’åˆ°å­¸é½¡å‰å…’ç«¥çš„å„ç¨®éœ€æ±‚ï¼ŒåŒ…æ‹¬èº«é«”ã€æƒ…æ„Ÿã€ç¤¾æœƒå’Œæ™ºåŠ›ç™¼å±•ã€‚å­¸ç”Ÿå°‡å­¸ç¿’å¦‚ä½•è¨­è¨ˆå’Œå¯¦æ–½é©åˆä¸åŒå¹´é½¡æ®µå…’ç«¥çš„æ•™è‚²å’Œä¿è‚²è¨ˆåŠƒã€‚' },
            { cat: 'å…’ç«¥ä¿è‚²å­¸é¡', dept: 'å®¶åº­èˆ‡å…’ç«¥ç™¼å±•å­¸ç³»', catintro: 'å…’ç«¥ä¿è‚²å­¸é¡ä¸»è¦ç ”ç©¶å’Œå¯¦è¸å¦‚ä½•ç…§é¡§ã€æ•™è‚²å’Œæ”¯æŒå…’ç«¥çš„å…¨é¢ç™¼å±•ã€‚é€™å€‹å­¸é¡æ¶µè“‹äº†å¾å¬°å¹¼å…’åˆ°å­¸é½¡å‰å…’ç«¥çš„å„ç¨®éœ€æ±‚ï¼ŒåŒ…æ‹¬èº«é«”ã€æƒ…æ„Ÿã€ç¤¾æœƒå’Œæ™ºåŠ›ç™¼å±•ã€‚å­¸ç”Ÿå°‡å­¸ç¿’å¦‚ä½•è¨­è¨ˆå’Œå¯¦æ–½é©åˆä¸åŒå¹´é½¡æ®µå…’ç«¥çš„æ•™è‚²å’Œä¿è‚²è¨ˆåŠƒã€‚' },
            { cat: 'è§€å…‰ä¼‘é–’å­¸é¡', dept: 'è§€å…‰ä¼‘é–’å­¸ç³»', catintro: 'è§€å…‰ä¼‘é–’å­¸é¡ä¸»è¦ç ”ç©¶å¦‚ä½•è¦åŠƒã€ç®¡ç†å’Œæ¨å»£è§€å…‰èˆ‡ä¼‘é–’æ´»å‹•ã€‚é€™å€‹å­¸é¡æ¶µè“‹äº†æ—…éŠç¶“æ¿Ÿå­¸ã€åœ‹éš›è§€å…‰ã€å¸‚å ´è¡ŒéŠ·ã€æ–‡åŒ–è³‡æºç®¡ç†ç­‰é ˜åŸŸï¼Œç›®çš„æ˜¯åŸ¹é¤Šå­¸ç”Ÿåœ¨é€™äº›é ˜åŸŸçš„å°ˆæ¥­çŸ¥è­˜å’Œå¯¦å‹™æŠ€èƒ½ã€‚' },
            { cat: 'è§€å…‰ä¼‘é–’å­¸é¡', dept: 'è§€å…‰ä¼‘é–’ç®¡ç†å­¸ç³»', catintro: 'è§€å…‰ä¼‘é–’å­¸é¡ä¸»è¦ç ”ç©¶å¦‚ä½•è¦åŠƒã€ç®¡ç†å’Œæ¨å»£è§€å…‰èˆ‡ä¼‘é–’æ´»å‹•ã€‚é€™å€‹å­¸é¡æ¶µè“‹äº†æ—…éŠç¶“æ¿Ÿå­¸ã€åœ‹éš›è§€å…‰ã€å¸‚å ´è¡ŒéŠ·ã€æ–‡åŒ–è³‡æºç®¡ç†ç­‰é ˜åŸŸï¼Œç›®çš„æ˜¯åŸ¹é¤Šå­¸ç”Ÿåœ¨é€™äº›é ˜åŸŸçš„å°ˆæ¥­çŸ¥è­˜å’Œå¯¦å‹™æŠ€èƒ½ã€‚' },
            { cat: 'è§€å…‰ä¼‘é–’å­¸é¡', dept: 'ä¼‘é–’éŠæ†©å­¸ç³»', catintro: 'è§€å…‰ä¼‘é–’å­¸é¡ä¸»è¦ç ”ç©¶å¦‚ä½•è¦åŠƒã€ç®¡ç†å’Œæ¨å»£è§€å…‰èˆ‡ä¼‘é–’æ´»å‹•ã€‚é€™å€‹å­¸é¡æ¶µè“‹äº†æ—…éŠç¶“æ¿Ÿå­¸ã€åœ‹éš›è§€å…‰ã€å¸‚å ´è¡ŒéŠ·ã€æ–‡åŒ–è³‡æºç®¡ç†ç­‰é ˜åŸŸï¼Œç›®çš„æ˜¯åŸ¹é¤Šå­¸ç”Ÿåœ¨é€™äº›é ˜åŸŸçš„å°ˆæ¥­çŸ¥è­˜å’Œå¯¦å‹™æŠ€èƒ½ã€‚' }
        ];

        const grouped = {};
        rawData.forEach(item => {
            if (!grouped[item.cat]) grouped[item.cat] = [];
            grouped[item.cat].push(item.dept);
        });

        const treeDiv = document.getElementById("treeMenu");
        let index = 1;
        // å»ºç«‹ tooltip å®¹å™¨
        const tooltip = document.createElement("div");
	    tooltip.classList.add("tooltip");
        //tooltip.style.position = "absolute";
        //tooltip.style.padding = "8px";
        //tooltip.style.background = "#15A83D";
        //tooltip.style.border = "0";
        //tooltip.style.borderRadius = "5px";
        //tooltip.style.boxShadow = "0 3px 6px rgba(0,0,0,0.15)";
        //tooltip.style.maxWidth = "280px";
        //tooltip.style.fontSize = "14px";
	    //tooltip.style.color= "#ffffff";
        //tooltip.style.lineHeight = "1.5";
        //tooltip.style.display = "none";
        //tooltip.style.zIndex = 999;
        document.body.appendChild(tooltip);

        for (const cat in grouped) {
            const wrapper = document.createElement("div");
			wrapper.classList.add("tree-menu-div");
            //wrapper.style.marginBottom = "10px";

            const catTitle = document.createElement("div");
            catTitle.innerHTML = `${index}. <span>${cat}</span>`;
			catTitle.classList.add("tree-menu-title");
            //catTitle.style.cursor = "pointer";
            //catTitle.style.fontWeight = "bold";
            //catTitle.style.color = "#3366cc";
            //catTitle.style.marginBottom = "4px";

            const ul = document.createElement("ul");
			ul.classList.add("tree-menu-ul");
			ul.style.display = "none";
            //ul.style.marginLeft = "20px";

            grouped[cat].forEach((dept, i) => {
                const li = document.createElement("li");
                li.textContent = ` ${dept}`;
                ul.appendChild(li);
            });

            // é¡¯ç¤º tooltip
            catTitle.addEventListener("mouseover", function (e) {
                const item = rawData.find(x => x.cat === cat);
                if (item && item.catintro) {
                    tooltip.innerText = item.catintro;
                    tooltip.style.left = `${e.pageX + 30}px`;
                    tooltip.style.top = `${e.pageY + 0}px`;
                    tooltip.style.display = "block";
                }
            });

            catTitle.addEventListener("mousemove", function (e) {
                tooltip.style.left = `${e.pageX + 30}px`;
                tooltip.style.top = `${e.pageY + 0}px`;
            });

            catTitle.addEventListener("mouseout", function () {
                tooltip.style.display = "none";
            });

            // é»æ“Šé¡åˆ¥åç¨±ï¼šé–ƒçˆä¸¦æ”¶åˆ/å±•é–‹ 
            catTitle.addEventListener("click", function () {
                const isHidden = ul.style.display === "none";
                ul.style.display = isHidden ? "block" : "none";
                if (isHidden) {
                    highlightPointsByNamePart(cat);
                }
            });

            wrapper.appendChild(catTitle);
            wrapper.appendChild(ul);
            treeDiv.appendChild(wrapper);
            index++;
        }
        //for (const cat in grouped) {
        //    const wrapper = document.createElement("div");
        //    wrapper.style.marginBottom = "10px";

        //    const catTitle = document.createElement("div");
        //    catTitle.textContent = `${index}. ${cat}`;
        //    catTitle.style.cursor = "pointer";
        //    catTitle.style.fontWeight = "bold";
        //    catTitle.style.color = "#3366cc";
        //    catTitle.style.marginBottom = "4px";

        //    //const ul = document.createElement("ul");
        //    //ul.style.marginLeft = "20px";
        //    //ul.style.display = "none"; // âœ… é è¨­æ”¶åˆ

        //    //grouped[cat].forEach((dept, i) => {
        //    //    const li = document.createElement("li");
        //    //    li.textContent = ` ${dept}`;
        //    //    ul.appendChild(li);
        //    //});
        //    // åŠ å…¥æ»‘é¼ æç¤ºæ–‡å­—
        //    const catIntro = rawData.find(item => item.cat === cat)?.catintro || "";
        //    catTitle.title = catIntro;

        //    const ul = document.createElement("ul");
        //    ul.style.marginLeft = "20px";
        //    ul.style.display = "none";

        //    grouped[cat].forEach((dept, i) => {
        //        const li = document.createElement("li");
        //        li.textContent = ` ${dept}`;
        //        ul.appendChild(li);
        //    });

        //    // âœ… é»æ“Šé¡åˆ¥åç¨±ï¼šé–ƒçˆä¸¦æ”¶åˆ/å±•é–‹
        //    catTitle.addEventListener("click", function () {
        //        const isHidden = ul.style.display === "none";
        //        ul.style.display = isHidden ? "block" : "none";
        //        if (isHidden) {
        //            // å±•é–‹æ™‚æ‰åŸ·è¡Œé–ƒçˆ
        //            highlightPointsByNamePart(cat);
        //        }
        //    });

        //    wrapper.appendChild(catTitle);
        //    wrapper.appendChild(ul);
        //    treeDiv.appendChild(wrapper);
        //    index++;
        //}

        // === ğŸ”” ä¾åç¨±ç‰‡æ®µæœå°‹ä¸¦é–ƒçˆæ‰€æœ‰ç¬¦åˆçš„é» ===
        function highlightPointsByNamePart(keyword) {
            const allData = myDiv.data;

            allData.forEach((trace, traceIndex) => {
                if (trace.text) {
                    trace.text.forEach((text, pointIndex) => {
                        if (text.includes(keyword)) {
                            blinkPoint(traceIndex, pointIndex, 3, 150);
                        }
                    });
                }
            });
        }

        function blinkPoint(traceIndex, pointIndex, blinkCount, interval) {
            var traceData = myDiv.data[traceIndex];

            let sizeArray = (typeof traceData.marker.size === 'number')
                ? new Array(traceData.x.length).fill(traceData.marker.size)
                : [...traceData.marker.size];

            let colorArray = (typeof traceData.marker.color === 'string')
                ? new Array(traceData.x.length).fill(traceData.marker.color)
                : [...traceData.marker.color];

            const originalSize = sizeArray[pointIndex];
            const originalColor = colorArray[pointIndex];

            let count = 0;
            let visible = false;

            const timer = setInterval(function () {
                // sizeArray[pointIndex] = visible ? 20 : 7;
                sizeArray[pointIndex] = visible ? 20 : 7;
                colorArray[pointIndex] = visible ? 'red' : 'rgba(255,0,0,0.05)';

                Plotly.restyle('myDiv', {
                    'marker.size': [sizeArray],
                    'marker.color': [colorArray]
                }, [traceIndex]);

                visible = !visible;
                count++;

                if (count >= blinkCount * 2) {
                    clearInterval(timer);
                    sizeArray[pointIndex] = originalSize;
                    colorArray[pointIndex] = originalColor;

                    Plotly.restyle('myDiv', {
                        'marker.size': 7,
                        'marker.color': [colorArray]
                    }, [traceIndex]);
                }
            }, interval);
        }



        // ç”¢ç”Ÿ datalist é¸é …
        const dataList = document.getElementById("Drop_dept");
        itemCs.forEach(item => {
            if (item.ccont) {
                const option = document.createElement("option");
                option.value = item.ccont;
                dataList.appendChild(option);
            }
        });



        document.getElementById("btnClearSearch").addEventListener("click", function () {
            // æ¸…é™¤æœå°‹æ¬„ä½èˆ‡çµæœæ–‡å­—
            document.getElementById("Searchdeptstr").value = "";
            document.getElementById("resultdiv").innerHTML = "";

            // å®šç¾©å­¸é¡åç¨±èˆ‡å°æ‡‰é¡è‰²
            const colorMap = {
                "è¿‘": "#008080",
                "ä¸­": "#FFD700",
                "é ": "#4B0082"
            };


            // å›å¾©æ‰€æœ‰é»èˆ‡æ–‡å­—
            myDiv.data.forEach((trace, traceIndex) => {
                if (["è¿‘", "ä¸­", "é "].includes(trace.name)) {
                    const originalSize = 7;
                    const sizeArray = new Array(trace.x.length).fill(originalSize);
                    const colorArray = new Array(trace.x.length).fill(colorMap[trace.name]);
                    const textArray = trace.text_raw || [...trace.text];  // ä½¿ç”¨åŸå§‹å‚™ä»½çš„ textï¼Œå¦‚æœæœ‰çš„è©±


                    // è‹¥ç¬¬ä¸€æ¬¡é‚„æ²’æœ‰å‚™ä»½ text_rawï¼Œå‚™ä»½èµ·ä¾†
                    if (!trace.text_raw) {
                        trace.text_raw = [...trace.text];
                    }

                    Plotly.restyle('myDiv', {
                        'marker.size': 7,
                        'marker.color': [colorArray],
                        'text': [trace.text_raw]
                    }, [traceIndex]);
                }
            });
        });

        function removeHtmlTags(str) {
            // return str.replace(/<[^>]*>/g, '');
            return str.replace(/<b>\d+<\/b>\s*/g, '').trim();
        }
        // é»æ“Šæœå°‹å¾Œè§¸ç™¼
        document.getElementById("button-addon2").addEventListener("click", function () {
            const inputStr = document.getElementById("Searchdeptstr").value.trim();
            if (!inputStr) return;

            // é€²è¡Œæ¨¡ç³Šæœå°‹
            const matched = itemCs.filter(item => removeHtmlTags(item.ccont).includes(inputStr));
            const resultDiv = document.getElementById("resultdiv");

            if (matched.length === 0) {
                resultDiv.innerHTML = `<div class="info-panel-card">æŸ¥ç„¡èˆ‡<big class="strong text-secondary">${inputStr}</big>ç›¸é—œçš„å­¸ç³»è³‡æ–™ã€‚</div>`;
                return;
            }

            // æ”¶é›†å°æ‡‰çš„ bcont å»é™¤é‡è¤‡
            //const resultSet = new Set();
            //matched.forEach(item => resultSet.add(item.bcont));

            // å»é™¤é‡è¤‡ bcontï¼ˆå­¸é¡ï¼‰
            //const resultSet = new Set();
            //matched.forEach(item => resultSet.add(item.bcont));
            //const resultText = Array.from(resultSet).join(" / ");


            // è¼¸å‡ºçµæœ

            // é¡¯ç¤ºè¼¸å‡ºæ–‡å­—
  //          resultDiv.innerHTML = `
  //  ã€Œ<strong>${inputStr}</strong>ã€ç§‘ç³»åˆ†é¡åœ¨ <strong>${resultText}</strong> ï¼Œ
  //  æ­¤å­¸é¡èˆ‡ä½ ç‰¹è³ªçš„é©é…åº¦ç‚º <strong>AA</strong>ã€‚
  //`;
            //const resultText = Array.from(resultSet).join(" / ");



            // alert("å°æ‡‰çš„å­¸é¡ç‚ºï¼š\n" + resultText);



            // æ”¶é›†å­¸é¡èˆ‡å­¸ç³»åç¨±
            const matchBcontSet = new Set();
            const matchCcontSet = new Set();
            matched.forEach(item => {
                matchBcontSet.add(item.bcont);
                matchCcontSet.add(item.ccont);
            });

            const resultList = Array.from(matchBcontSet);


          //  const resultText = Array.from(matchBcontSet).join(" / ");
         //   resultDiv.innerHTML = `ã€Œ<strong>${inputStr}</strong>ã€ç§‘ç³»åˆ†é¡åœ¨ <strong>${resultText}</strong> å­¸é¡ï¼Œæ­¤å­¸é¡èˆ‡ä½ ç‰¹è³ªçš„é©é…åº¦ç‚º <strong>AA</strong>ã€‚`;
            if (resultList.length === 1) {
                // âœ… å–®ä¸€å­¸é¡ï¼šæ­£å¸¸è¼¸å‡º
                resultDiv.innerHTML = `
               <div class="info-panel-card">
                 <big class="strong text-secondary">${inputStr}</big>ç§‘ç³»åˆ†é¡åœ¨ 
                  <strong>${resultList[0]}</strong>ï¼Œæ­¤å­¸é¡èˆ‡ä½ ç‰¹è³ªçš„é©é…åº¦ç‚º <strong>AA</strong>ã€‚
                  <br/><br/><small class="text-primary">* é©é…åº¦ç‚º50ä»¥ä¸Šå»ºè­°å„ªå…ˆæ¢ç´¢</small>
	           </div>
    `;
            } else {
                //  å¤šå­¸é¡è¼¸å‡ºï¼Œåƒ…åˆ—å‰ 10 ç­†
                let html = `<div class="info-panel-card"><big class="strong text-secondary">${inputStr}</big>ç§‘ç³»åˆ†é¡åœ¨ï¼š<br/>`;

                const displayLimit = 10;
                const limitedList = resultList.slice(0, displayLimit);

                limitedList.forEach((cat, i) => {
                    html += `<strong>${cat}</strong>  (é©é…åº¦ç‚º <strong>AA${i + 1}</strong>)<br/>`;
                });

                if (resultList.length > displayLimit) {
                    html += `...ç­‰å…± <strong>${resultList.length}</strong> é¡ã€‚`;
                }
                html += `<br/><small class="text-primary">ä»¥ä¸Šå­¸é¡çš„é©é…åº¦è‹¥ç‚º50ä»¥ä¸Šå»ºè­°å„ªå…ˆæ¢ç´¢ã€‚</small></div>`;
                resultDiv.innerHTML = html;
            }



            // è™•ç†è¿‘ / ä¸­ / é  ä¸‰å€‹ trace
            myDiv.data.forEach((trace, traceIndex) => {
                if (["è¿‘", "ä¸­", "é "].includes(trace.name)) {
                    // âœ… ç¬¬ä¸€æ¬¡æœå°‹å‰å‚™ä»½åŸå§‹æ–‡å­—
                    if (!trace.text_raw) {
                        trace.text_raw = [...trace.text];
                    }
              
                    
                    //console.log(matchBcontSet);
                    const newSizes = [];
                  //  const newColors = [];
                    const newTexts = [];

                    trace.text.forEach((text, pointIndex) => {
                        if (matchBcontSet.has(removeHtmlTags(text))) {
                            newSizes.push(15); // é¡¯ç¤ºå¤§å°
                           // newColors.push(trace.marker.color); // åŸé¡è‰²
                            newTexts.push(text); // é¡¯ç¤ºæ–‡å­—
                         //   console.log("ç¬¦åˆ", text, removeHtmlTags(text));
                        } else {
                            newSizes.push(1); // éš±è—
                          //  newColors.push(trace.marker.color);
                            newTexts.push(''); // éš±è—æ–‡å­—
                          //  console.log("ä¸ç¬¦åˆ", text, removeHtmlTags(text));
                        }
                    });


                    Plotly.restyle('myDiv', {
                        'marker.size': [newSizes] ,
                        'text': [newTexts]
                    }, [traceIndex]);
                }
            });


        });









        // ä½¿ç”¨ d3.js è¼‰å…¥ CSV æª”æ¡ˆ
        d3.csv("data1.csv").then(function (data) {
            var plotData = [];
            var colorMap = {
                "Teal": "#008080",
                "Golden Yellow": "#FFD700",
                "Indigo": "#4B0082",
                "Red": "#FF0000"
            };

            // å®šç¾©åç¨±å°æ‡‰
            var nameMap = {
                "#008080": "è¿‘",
                "#FFD700": "ä¸­",
                "#4B0082": "é ",
                "#FF0000": "æœ¬äºº"
            };

            // ä¾æ“šé¡è‰²åˆ†é¡é»è³‡æ–™
            var colorGroups = {};
            data.forEach(function (row) {
                var color = row.color;
                var mappedColor = colorMap[color] || "#000000"; // é è¨­ç‚ºé»‘è‰²ï¼Œå¦‚æœç„¡æ³•åŒ¹é…

                // å¦‚æœè©²é¡è‰²å°šæœªåˆå§‹åŒ–ï¼Œå‰‡åˆå§‹åŒ–çµæ§‹
                if (!colorGroups[mappedColor]) {
                    colorGroups[mappedColor] = {
                        x: [],
                        y: [],
                        z: [],
                        text: [],
                        color: mappedColor,
                        links: []
                    };
                }

                // æ·»åŠ åº§æ¨™èˆ‡æ¨™ç±¤åˆ°å°æ‡‰é¡è‰²çš„çµ„ä¸­
                colorGroups[mappedColor].x.push(parseFloat(row.x));
                colorGroups[mappedColor].y.push(parseFloat(row.y));
                colorGroups[mappedColor].z.push(parseFloat(row.z));
                colorGroups[mappedColor].text.push(row.cname);
                colorGroups[mappedColor].links.push(row.link);
            });

            // å°‡æ¯å€‹é¡è‰²çµ„çš„è³‡æ–™è½‰æ›ç‚º Plotly å¯ç”¨çš„æ ¼å¼
            Object.keys(colorGroups).forEach(function (color) {
                var group = colorGroups[color];
                plotData.push({
                    x: group.x,
                    y: group.y,
                    z: group.z,
                    mode: 'markers+text',
                    marker: {
                        size: 7,
                        color: group.color,
                        line: {
                            color: 'rgba(217, 217, 217, 0.14)',
                            width: 0.5
                        },
                        opacity: 0.8
                    },
                    type: 'scatter3d',
                    text: group.text,
                    textposition: 'top center',
                    hoverinfo: 'text',
                    customdata: group.links,
                    hovertemplate: '<span><a href="http://140.122.118.47/CareerInfo/explore2.aspx?cate=%{customdata}" target="_blank" style="color:white; font-weight:bold;font-size:24px;">%{text}</a></span><extra></extra>',
                    name: nameMap[color] || "æœªå®šç¾©"
                });
            });



            // æ·»åŠ ã€Œè‡ªç”±ã€å’Œã€Œè¦æº–ã€çš„æ¨™ç¤º
            plotData.push({
                x: [2.2, -2.2, 0, 0, 0, 0],
                y: [0, 0, 2.2, -2.2, 0, 0],
                z: [0, 0, 0, 0, 2.2, -2.2],
                mode: 'markers+text',
                type: 'scatter3d',
                text: ['è‡ªç”±(X+)', 'è¦æº–(X-)', 'äº‹(Y+)', 'äºº(Y-)', 'æ€è€ƒ(Z+)', 'å¯¦ä½œ(Z-)'],
                textposition: 'top center',
                hoverinfo: 'none',
                marker: {
                    size: 4,
                    color: 'lightgray',             // âœ… æ·ºç°è‰²
                    opacity: 0.8
                }, name: 'ç©ºé–“è»¸æ¨™ç¤º',
                showlegend: true,                   // âœ… é¡¯ç¤ºåœ–ä¾‹
                legendgroup: 'axes'                 // âœ… å¯åŠ é€™è¡Œé¿å…é‡è¤‡
            });



            // ä½ˆå±€é…ç½®
            //var layout = {
            //    legend: {
            //        x: 1.05,   // è¶…å‡ºåœ–è¡¨å³é‚Š
            //        y: 0.5,
            //        xanchor: 'left',
            //        orientation: 'v'
            //    },
            //    margin: {
            //        l: 0,
            //        r: 0,
            //        b: 0,
            //        t: 0
            //    },
            //    scene: {
            //        xaxis: {
            //            title: {
            //                text: 'X è»¸',
            //                font: { size: 14 }
            //            },
            //            tickfont: {
            //                color: 'rgba(128, 128, 128, 0.7)', // ç°è‰²ä¸”é€æ˜
            //                size: 12
            //            }
            //        },
            //        yaxis: {
            //            title: {
            //                text: 'Y è»¸',
            //                font: { size: 14 }
            //            },
            //            tickfont: {
            //                color: 'rgba(128, 128, 128, 0.7)', // ç°è‰²ä¸”é€æ˜
            //                size: 12
            //            }
            //        },
            //        zaxis: {
            //            title: {
            //                text: 'Z è»¸',
            //                font: { size: 14 }
            //            },
            //            tickfont: {
            //                color: 'rgba(128, 128, 128, 0.7)', // ç°è‰²ä¸”é€æ˜
            //                size: 12
            //            }
            //        },
            //        camera: {
            //            eye: { x: 0.2838, y: -1.104, z: 0.305 }//,    up: { x: 0, y: 0, z:1 }
            //        }
            //    }
            //};
            function generateSphereWireframe(radius, step) {
                const lines = [];
                const phiStep = step;
                const thetaStep = step;

                for (let phi = 0; phi <= Math.PI; phi += phiStep) {
                    const x = [], y = [], z = [];
                    for (let theta = 0; theta <= 2 * Math.PI; theta += thetaStep) {
                        x.push(radius * Math.sin(phi) * Math.cos(theta));
                        y.push(radius * Math.sin(phi) * Math.sin(theta));
                        z.push(radius * Math.cos(phi));
                    }
                    lines.push({
                        type: 'scatter3d',
                        mode: 'lines',
                        x, y, z,
                        line: { color: 'lightgray', width: 1 },
                        hoverinfo: 'skip',
                        showlegend: false
                    });
                }

                for (let theta = 0; theta <= Math.PI; theta += thetaStep) {
                    const x = [], y = [], z = [];
                    for (let phi = 0; phi <= Math.PI; phi += phiStep) {
                        x.push(radius * Math.sin(phi) * Math.cos(theta));
                        y.push(radius * Math.sin(phi) * Math.sin(theta));
                        z.push(radius * Math.cos(phi));
                    }
                    lines.push({
                        type: 'scatter3d',
                        mode: 'lines',
                        x, y, z,
                        line: { color: 'lightgray', width: 1 },
                        hoverinfo: 'skip',
                        showlegend: false
                    });
                }

                return lines;
            }

            // åŠ å…¥å¤–åœå…‰æšˆæ˜Ÿé»æ•ˆæœ
            function generateOuterGlowPoints(numPoints, minR, maxR) {
                const x = [], y = [], z = [];
                for (let i = 0; i < numPoints; i++) {
                    const theta = Math.random() * 2 * Math.PI;
                    const phi = Math.acos(2 * Math.random() - 1);
                    const r = minR + Math.random() * (maxR - minR);
                    x.push(r * Math.sin(phi) * Math.cos(theta));
                    y.push(r * Math.sin(phi) * Math.sin(theta));
                    z.push(r * Math.cos(phi));
                }
                return [{
                    type: 'scatter3d',
                    mode: 'markers',
                    x, y, z,
                    marker: {
                        size: 6,
                        color: 'rgba(255, 100, 255, 0.7)',
                        opacity: 0.3
                    },
                    hoverinfo: 'skip',
                    showlegend: false
                }];
            }


            console.log("é–‹å§‹ç•«åœ–");
            const loadingDiv = document.getElementById("loadingMessage");
            loadingDiv.style.display = "block"; // âœ… é¡¯ç¤ºè¼‰å…¥æç¤º
            // åœ¨ç¶²é ä¸Šç¹ªè£½åœ–å½¢
            // Plotly.newPlot('myDiv', plotData, layout);
            Plotly.newPlot('myDiv', [
                ...plotData,
                ...generateSphereWireframe(2.2, 0.2)
            ], {
                scene: {
                    xaxis: { visible: false },
                    yaxis: { visible: false },
                    zaxis: { visible: false },
                    bgcolor: 'rgba(255,255,255,1)',
                    camera: { eye: { x: 0.8, y: 0.8, z: 0.8 } }
                },
                paper_bgcolor: 'white',
                plot_bgcolor: 'white',
                margin: { l: 0, r: 0, b: 0, t: 0 },
                legend: {
                    x: 1.05,
                    y: 0.5,
                    xanchor: 'left',
                    orientation: 'v'
                }
            });


            console.log("çµæŸç•«åœ–");


            loadingDiv.style.display = "none";

            document.getElementById('myDiv').on('plotly_click', function (data) {
                var point = data.points[0]; // åªè™•ç†ç¬¬ä¸€å€‹é»ï¼ˆä¸€èˆ¬é»ä¸€å€‹é»å³å¯ï¼‰
                var name = point.text; // cname å°æ‡‰çš„å€¼
                console.log("ä½ é»æ“Šäº†åº§æ¨™åç¨±ï¼š" + name);



            });

            // è‡ªå‹•æ—‹è½‰æ§åˆ¶
            var rotating = false;
            var rotationInterval;
            var currentEye = { x: 0.2838, y: -1.104, z: 0.305 };

            function startRotation() {
                rotating = true;
                rotationInterval = setInterval(function () {
                    const angle = 0.005;
                    const cosA = Math.cos(angle);
                    const sinA = Math.sin(angle);

                    // æ›´æ–°è¦–è§’ï¼ˆä¿æŒç›¸å°ä½ç½®ï¼‰
                    const newX = cosA * currentEye.x - sinA * currentEye.y;
                    const newY = sinA * currentEye.x + cosA * currentEye.y;
                    currentEye.x = newX;
                    currentEye.y = newY;

                    Plotly.relayout('myDiv', {
                        'scene.camera.eye': currentEye
                    });
                }, 20);
            }

            function stopRotation() {
                rotating = false;
                clearInterval(rotationInterval);
            }

            document.getElementById('toggleRotation').addEventListener('click', function () {
                if (rotating) {
                    stopRotation();
                    this.textContent = 'æ—‹è½‰å±•ç¤º';
					this.classList.remove('rotating');
                } else {
                    startRotation();
                    this.textContent = 'æš«åœæ—‹è½‰';
					this.classList.add('rotating');
                }
            });

            // é»æ“ŠæŒ‰éˆ•å¾Œï¼Œå¼·èª¿ç‰¹å®šé»
            document.getElementById('highlightBtn').addEventListener('click', function () {
                //highlightPoint(0, 11); // é€™è£¡å¯ä»¥æ”¹æˆä½ æƒ³è¦å¼·èª¿çš„ trace èˆ‡é» index
                blinkPoint(0, 11, 5, 200);
            });

            // å®šç¾©å‡½å¼ï¼šå°‡æŒ‡å®š trace çš„æŒ‡å®šé»æ”¹ç‚ºå¤§ç´…è‰²
            function highlightPoint(traceIndex, pointIndex) {
                var traceData = myDiv.data[traceIndex];

                // è‹¥ marker.size ç‚ºå–®ä¸€æ•¸å­—ï¼Œéœ€è½‰æˆé™£åˆ—
                var originalSize = (typeof traceData.marker.size === 'number')
                    ? new Array(traceData.x.length).fill(traceData.marker.size)
                    : [...traceData.marker.size];
                var originalColor = (typeof traceData.marker.color === 'string')
                    ? new Array(traceData.x.length).fill(traceData.marker.color)
                    : [...traceData.marker.color];

                // ä¿®æ”¹æŒ‡å®šé»
                originalSize[pointIndex] = 30;
                originalColor[pointIndex] = 'red';

                // å¥—ç”¨æ›´æ–°
                Plotly.restyle('myDiv', {
                    'marker.size': [originalSize],
                    'marker.color': [originalColor]
                }, [traceIndex]);
            }

            function blinkPoint(traceIndex, pointIndex, blinkCount, interval) {
                var traceData = myDiv.data[traceIndex];

                // ç¢ºä¿ size èˆ‡ color æ˜¯é™£åˆ—æ ¼å¼ï¼ˆé‡å°æ¯å€‹é»ï¼‰
                let sizeArray = (typeof traceData.marker.size === 'number')
                    ? new Array(traceData.x.length).fill(traceData.marker.size)
                    : [...traceData.marker.size];

                let colorArray = (typeof traceData.marker.color === 'string')
                    ? new Array(traceData.x.length).fill(traceData.marker.color)
                    : [...traceData.marker.color];

                // âœ… å„²å­˜è©²é»çš„åŸå§‹æ¨£å¼
                const originalSize = sizeArray[pointIndex];
                const originalColor = colorArray[pointIndex];

                console.log("sizeArray", sizeArray);
                console.log("originalSize", originalSize);

                let count = 0;
                let visible = false;

                const timer = setInterval(function () {
                    // âœ… åªæ”¹è®Šè©²é»çš„å¤§å°èˆ‡é¡è‰²ï¼Œå…¶ä»–ä¸è®Š
                    sizeArray[pointIndex] = visible ? 20 : 7;
                    colorArray[pointIndex] = visible ? 'red' : 'rgba(255,0,0,0.05)';

                    Plotly.restyle('myDiv', {
                        'marker.color': [colorArray]
                    }, [traceIndex]);

                    visible = !visible;
                    count++;

                    if (count >= blinkCount * 2) {
                        clearInterval(timer);

                        // âœ… é‚„åŸè©²é»çš„æ¨£å¼
                        colorArray[pointIndex] = originalColor;

                        Plotly.restyle('myDiv', {
                            'marker.color': [colorArray]
                        }, [traceIndex]);
                    }
                }, interval);
            }


        });
    </script> 
<!--<div style="position: absolute; padding: 8px; background: rgb(249, 249, 249); border: 1px solid rgb(204, 204, 204); border-radius: 5px; box-shadow: rgba(0, 0, 0, 0.15) 0px 2px 8px; max-width: 250px; font-size: 13px; line-height: 1.5; display: none; z-index: 999; left: 1712px; top: 717px;">è§€å…‰ä¼‘é–’å­¸é¡ä¸»è¦ç ”ç©¶å¦‚ä½•è¦åŠƒã€ç®¡ç†å’Œæ¨å»£è§€å…‰èˆ‡ä¼‘é–’æ´»å‹•ã€‚é€™å€‹å­¸é¡æ¶µè“‹äº†æ—…éŠç¶“æ¿Ÿå­¸ã€åœ‹éš›è§€å…‰ã€å¸‚å ´è¡ŒéŠ·ã€æ–‡åŒ–è³‡æºç®¡ç†ç­‰é ˜åŸŸï¼Œç›®çš„æ˜¯åŸ¹é¤Šå­¸ç”Ÿåœ¨é€™äº›é ˜åŸŸçš„å°ˆæ¥­çŸ¥è­˜å’Œå¯¦å‹™æŠ€èƒ½ã€‚</div>-->
<svg id="js-plotly-tester" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="position: absolute; left: -10000px; top: -10000px; width: 9000px; height: 9000px; z-index: 1;">
  <path class="js-reference-point" d="M0,0H1V1H0Z" style="stroke-width: 0; fill: black;"></path>
</svg>
<div id="gtx-trans" style="position: absolute; left: 1395px; top: 6px;">
  <div class="gtx-trans-icon"></div>
</div>
</body>
</html>